
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>tangr206's Blog</title>
  <meta name="author" content="tom">

  
  <meta name="description" content="Here are the tips to help you become a better Python developer Use join() to glue a large number of strings: 大量字符串拼接使用join (还可以用来讲list等iterator转为str &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tangr206.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="tangr206's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">tangr206's Blog</a></h1>
  
    <h2>collections for my learning.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tangr206.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/25/python-performance-tips/">Python Performance Tips</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-25T19:56:00+08:00" pubdate data-updated="true">Apr 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://blog.monitis.com/index.php/2012/02/13/python-performance-tips-part-1/">Here are the tips to help you become a better Python developer</a></p>

<ol>
<li><h3>Use join() to glue a large number of strings:</h3>

<p>大量字符串拼接使用join (还可以用来讲list等iterator转为str)
You can use “+” to combine several strings. Since string is immutable in Python, every “+” operation involves creating a new string and copying the old content. A frequent idiom is to use Python’s array module to modify individual characters; when you are done, use the <code>join()</code> function to re-create your final string.</p></li>
</ol>


<blockquote><blockquote><blockquote><h1>This is good to glue a large number of strings</h1>

<p>for chunk in input():
   mystring.join(chunk)</p></blockquote></blockquote></blockquote>

<ol>
<li><h3>Use Python multiple assignment to swap variables:</h3>

<code>This is elegant and faster in Python:</code>

<blockquote><blockquote><blockquote><p>x, y = y, x
This is slower:
temp = x
x = y
y = temp</p></blockquote></blockquote></blockquote></li>
<li><h3>Speed up by lazy importing:</h3>

<p>if some modules are not needed right away, import them later.</p></li>
<li><h3>Use “while 1″ for the infinite loop:（pyhton3.x中和while true效率一样）</h3>

<p>“while 1″ is a single jump operation.（python2.x）
<a href="http://stackoverflow.com/questions/3815359/while-1-vs-for-whiletrue-why-is-there-a-difference">因为</a>
True是 built-in global constant ，所以解释器需要多一步to load the contents of True。
并且True是可以重新复制的(3以下版本)</p></li>
<li><h3>Use list comprehension</h3>

<blockquote><blockquote><blockquote><h1>the good way to iterate a range</h1>

<p>evens = [ i for i in range(10) if i%2 == 0]
[0, 2, 4, 6, 8]
解释器有机会做优化， 更易读， 节省变量</p></blockquote></blockquote></blockquote></li>
<li><h3>Learn bisect module for keeping a list in sorted order</h3></li>
<li><h3>Use Python generator to get value on demand:</h3>

<p><a href="http://tangr206.github.io/blog/2013/04/21/python-tee/">gengerator</a>
在需要的时候才返回对应的值</p></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">chunk</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">chunk</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">generator</span> <span class="nb">object</span> <span class="o">&lt;</span><span class="n">genexpr</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x7f65d90dcaa0</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">chunk</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
</span><span class='line'><span class="mi">0</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">chunk</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
</span><span class='line'><span class="mi">1000</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">chunk</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
</span><span class='line'><span class="mi">2000</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><h3>Understand that a Python list, is actually an array</h3>

<p>python  中的List就是数组，插入和删除的效率需要我们仔细斟酌</p></li>
<li><h3>map和set是用hash实现的，效率不错</h3></li>
<li><h2>Use sort() with Schwartzian Transform</h2>

<p>复杂的结构排序如果用list.sort(cmp())比较慢，因为有多次函数调用</p></li>
</ol>


<p> <a href="http://docs.python.org/2/faq/programming.html#i-want-to-do-a-complicated-sort-can-you-do-a-schwartzian-transform-in-python">Schwartzian Transform</a>
<code>I want to do a complicated sort: can you do a Schwartzian Transform in Python?</code>
The technique, attributed to Randal Schwartz of the Perl community, sorts the elements of a list by a metric which maps each element to its “sort value”. In Python, just use the key argument for the sort() method:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">Isorted</span> <span class="o">=</span> <span class="n">L</span><span class="p">[:]</span>
</span><span class='line'><span class="n">Isorted</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">]))</span>
</span></code></pre></td></tr></table></div></figure>


<p>The key argument is new in Python 2.4, for * older versions * this kind of sorting is quite simple to do with list comprehensions. To sort a list of strings by their uppercase values:</p>

<p>tmp1 = [(x.upper(), x) for x in L]  # Schwartzian transform
tmp1.sort()
Usorted = [x[1] for x in tmp1]
To sort by the integer value of a subfield extending from positions 10-15 in each string:</p>

<p>tmp2 = [(int(s[10:15]), s) for s in L]  # Schwartzian transform
tmp2.sort()
Isorted = [x[1] for x in tmp2]</p>

<ol>
<li><h3>Cache results with Python decorator:</h3>

The symbol “@” is Python decorator syntax. Use it not only for tracing, locking or logging. You can decorate a Python function so that it remembers the results needed later. This technique is called memoization. Here is an example:

<blockquote><blockquote><blockquote><p>from functools import wraps
def memo(f):
   cache = { }
   @wraps(f)
   def  wrap(*arg):</p>

<pre><code>   if arg not in cache: cache['arg'] = f(*arg)
   return cache['arg']
</code></pre>

<p>   return wrap
And we can use this decorator on a Fibonacci function:
@memo
def fib(i):
   if i &lt; 2: return 1
   return fib(i-1) + fib(i-2)
The key idea here is simple: enhance (decorate) your function to remember each Fibonacci term you’ve calculated; if they are in the cache, no need to calculate it again.</p></blockquote></blockquote></blockquote></li>
<li><h3>Understand Python GIL(global interpreter lock):</h3>

<p>GIL is necessary because CPython’s memory management is not thread-safe. You can’t simply create multiple threads and hope Python will run faster on a multi-core machine. It is because GIL will prevents multiple native threads from executing Python bytecodes at once. In other words, GIL will serialize all your threads. You can, however, speed up your program by using threads to manage several forked processes, which are running independently outside your Python code.</p></li>
<li><h2>#</h2></li>
<li><h2>#</h2></li>
<li><h2>#</h2></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/22/python-func/">Python 中有用的函数</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-22T21:12:00+08:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li><h2>lambda</h2>

<p><code>lambda</code>表达式返回一个函数对象
例子：
<code>func = lambda x,y:x+y</code>
func相当于下面这个函数
def func(x,y):
 return x+y
注意def是语句而lambda是表达式
下面这种情况下就只能用lambda而不能用def
<code>[(lambda x:x*x)(x) for x in range(1,11)]</code></p></li>
</ol>


<p>map，reduce，filter中的function都可以用lambda表达式来生成</p>

<ol>
<li><h2>max</h2></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="mi">34</span><span class="p">)]</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">oprator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><h2>filter</h2>

<p>filter 函数的功能相当于过滤器。
调用一个布尔函数bool_func来迭代遍历每个seq中的元素；
返回一个使bool_seq返回值为true的元素的序列。</p></li>
</ol>


<figure class='code'><figcaption><span>filter</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="mi">34</span><span class="p">)]</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">12</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
</span><span class='line'><span class="p">[(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">)]</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><h2>map</h2>

<p>map函数func作用于给定序列的每个元素，并用一个列表来提供返回值</p></li>
</ol>


<figure class='code'><figcaption><span>map</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="mi">34</span><span class="p">)]</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">)</span>   <span class="c">#or</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">)</span>
</span><span class='line'><span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">34</span><span class="p">]</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="nb">map</span><span class="p">(</span><span class="nb">pow</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span class='line'><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">243</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><h2>reduce</h2>

<p>reduce函数，func为二元函数，将func作用于seq序列的元素，
<code>每次携带一对（先前的结果以及下一个序列的元素）</code>
连续的将现有的结果和下一个值作用在获得的随后的结果上，
最后减少我们的序列为一个单一的返回值。</p></li>
</ol>


<figure class='code'><figcaption><span>map</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</span><span class='line'><span class="mi">28</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><h2>itertools.cycle(iterable)</h2>

<p>Make an iterator returning elements from the iterable and saving a copy of each.
When the iterable is exhausted, return elements from the saved copy.
Repeats indefinitely. Equivalent to:</p></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">cycle</span><span class="p">(</span><span class="n">iterable</span><span class="p">):</span>
</span><span class='line'>    <span class="c"># cycle(&#39;ABCD&#39;) --&gt; A B C D A B C D A B C D ...</span>
</span><span class='line'>    <span class="n">saved</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
</span><span class='line'>        <span class="k">yield</span> <span class="n">element</span>
</span><span class='line'>        <span class="n">saved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
</span><span class='line'>    <span class="k">while</span> <span class="n">saved</span><span class="p">:</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">saved</span><span class="p">:</span>
</span><span class='line'>              <span class="k">yield</span> <span class="n">element</span>
</span></code></pre></td></tr></table></div></figure>


<p>注意：因为cycle缓存了中间结果，如果iterable很长的话&#8230;
<code>Note, this member of the toolkit may require significant auxiliary storage (depending on the length of the iterable).</code></p>

<ol>
<li><h2>itertools.repeat()</h2>

<p>python的heapq.py模块中有这样一个用法：
<code>return map(heappop, repeat(h, min(n, len(h)))) #返回n个h（heappop n次）</code>
其中heappop弹出headp的堆顶，并维护堆结构</p></li>
</ol>


<p><a href="http://stackoverflow.com/questions/9059173/what-is-the-purpose-in-pythons-itertools-repeat">stack overflow</a>
The itertools.repeat function is lazy; it only uses the memory required for one item.
On the other hand, the (a)*n and [a]*n idioms _ create n copies of the object in memory_.
For five items, the multiplication idiom is probably better,
but you might notice a resource problem if you had to repeat something, say, a million times.</p>

<p>Minor quibble: [a]*n does not create n copies of a in memory.
<strong> It creates n references to a single copy of a </strong>.
In some cases the difference can be quite significant; try a = [[]]*5; a[0].append(1). – Thomas K Jan 30 &#8216;12 at 12:49</p>

<p>Good point. I keep forgetting that almost <strong> everything in Python is a reference </strong>.<br/>
I guess that also abates the memory usage problem somewhat,
but I&#8217;d guess a million references still has a nontrivial resource requirement. – mlefavor Jan 30 &#8216;12 at 15:22</p>

<p>Yep, it would still have to <strong> allocate an array of n pointers. </strong> – Thomas K Jan 30 &#8216;12 at 19:42</p>

<ol>
<li><h2>str.join()</h2>

<p>可以用来将list快速转为str</p></li>
</ol>


<p>并且因为python中字符川都是常量(字符串创建后是只读的)，所以<strong> 大量字符 </strong>用+来链接字符串会不停地
产生中间字符串，浪费内存
<code>s = "aaa" + "aaa" + "aaa" + "aaa" + "aaa" + "aaa"</code>
可以用join替代：
<code>"".join("aaa","aaa","aaa","aaa","aaa","aaa","aaa","aaa","aaa","aaa",)</code></p>

<p><a href="http://www.douban.com/group/topic/12795262/">引用</a>
<code>python字符串相加效率并不比join低，相反效率更高。但每个加号都创造额外字符串，10个字符串相加就会再创造出9个字符串，但我们只要1个，所以用join，节约内存，而不是节约cpu</code>
<code>python cookbook第一章有讲过,字符串对象是immutable，任何对字符串的操作都将创建一个新的字符串对象，而不是改变原来的对象.因此N个字符串相加必将丢弃中间N-1个结果, 只是两个字符串相加，效果不是很明显</code></p>

<p> |  join(&#8230;)
 |      S.join(iterable) -> string
 |    <br/>
 |      Return a string which is the concatenation of the strings in the
 |      iterable.  The separator between elements is S.</p>

<p>用array有<a href="http://www.python.org/doc/essays/list2str.html">更快</a>的表现</p>

<ol>
<li><h2><a href="http://woodpecker.org.cn/diveintopython/native_data_types/tuples.html">tuple</a></h2>

<p>使用 tuple 有什么好处呢？</p></li>
</ol>


<p>Tuple 比 list 操作速度快。如果您定义了一个值的常量集，并且唯一要用它做的是不断地遍历它，请使用 tuple 代替 list。
如果对不需要修改的数据进行 “写保护”，可以使代码更安全。使用 tuple 而不是 list 如同拥有一个隐含的 assert 语句，说明这一数据是常量。如果必须要改变这些值，则需要执行 tuple 到 list 的转换 (需要使用一个特殊的函数)。
还记得我说过 dictionary keys 可以是字符串，整数和 “其它几种类型”吗？Tuples 就是这些类型之一。Tuples 可以在 dictionary 中被用做 key，但是 list 不行。实际上，事情要比这更复杂。Dictionary key 必须是不可变的。Tuple 本身是不可改变的，但是如果您有一个 list 的 tuple，那就认为是可变的了，用做 dictionary key 就是不安全的。只有字符串、整数或其它对 dictionary 安全的 tuple 才可以用作 dictionary key。
Tuples 可以用在字符串格式化中，我们会很快看到。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/21/python-tee/">Python Tee</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-21T18:08:00+08:00" pubdate data-updated="true">Apr 21<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>部分摘自 <a href="http://jezng.com/2012/06/inside-python-tee/#fn:1">Inside Python&#8217;s itertools.tee()</a></p>

<p><img src="/images/2013/python_tee.png" alt="tee" /></p>

<h3>WHAT</h3>

<p>python.iteratools.tee :
<strong> <code>Return n independent iterators from a single iterable.</code> </strong></p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/04/21/python-tee/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/21/linux-command-learning/">Linux Command 收集</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-21T16:59:00+08:00" pubdate data-updated="true">Apr 21<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><h3>find 查找当前目录下在5分钟内被**过的文件</h3>

<p><code>find . -amin -5</code></p></li>
<li>访问过用amin，修改过用mmin，文件状态改变过用cmin</li>
<li>精确到分钟的用i <strong> amin,mmin,cmin </strong></li>
<li>精确到天的用 <strong> atime,mtime,ctime </strong></li>
<li>在5分钟之内的用-5，在5分钟以上的用＋5</li>
</ul>


<hr />
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/19/python-sort/">Python 排序</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-19T17:49:00+08:00" pubdate data-updated="true">Apr 19<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.python.org/dev/peps/pep-0265/">字典排序入门,</a> : 解释为什么python中的字典不提供sort函数</p>

<p><a href="http://zuroc.42qu.com/10492195">Python中最快的字典排序方法</a> : 简单的说, 用itemgetter比lambda快, iteritems比其他快</p>

<p><a href="http://docs.python.org/2/faq/programming.html#i-want-to-do-a-complicated-sort-can-you-do-a-schwartzian-transform-in-python">Schwartzian Transform(施瓦茨变换)</a></p>

<ul>
<li><h4>复杂结构指定Key排序</h4>

<p>先看一个例子：</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">D</span> <span class="o">=</span> <span class="p">{</span>   <span class="s">&quot;serverA&quot;</span><span class="p">:{</span> <span class="s">&quot;04-12&quot;</span><span class="p">:[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1333</span><span class="p">,</span> <span class="mi">1232343</span><span class="p">],</span> <span class="s">&quot;04-15&quot;</span><span class="p">:[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">15555</span><span class="p">,</span> <span class="mi">343432</span><span class="p">],</span> <span class="s">&quot;04-13&quot;</span><span class="p">:[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">44444</span><span class="p">,</span> <span class="mi">45454</span><span class="p">]},</span>  \
</span><span class='line'>        <span class="s">&quot;serverB&quot;</span><span class="p">:{</span> <span class="s">&quot;04-12&quot;</span><span class="p">:[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2333</span><span class="p">,</span> <span class="mi">1232343</span><span class="p">],</span> <span class="s">&quot;04-15&quot;</span><span class="p">:[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">35555</span><span class="p">,</span> <span class="mi">343432</span><span class="p">],</span> <span class="s">&quot;04-13&quot;</span><span class="p">:[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">34444</span><span class="p">,</span> <span class="mi">45454</span><span class="p">]},</span> \
</span><span class='line'>        <span class="s">&quot;serverC&quot;</span><span class="p">:{</span> <span class="s">&quot;04-12&quot;</span><span class="p">:[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3333</span><span class="p">,</span> <span class="mi">1232343</span><span class="p">],</span> <span class="s">&quot;04-15&quot;</span><span class="p">:[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">25555</span><span class="p">,</span> <span class="mi">343432</span><span class="p">],</span> <span class="s">&quot;04-13&quot;</span><span class="p">:[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">24444</span><span class="p">,</span> <span class="mi">45454</span><span class="p">]},</span> \
</span><span class='line'>        <span class="s">&quot;serverD&quot;</span><span class="p">:{</span> <span class="s">&quot;04-12&quot;</span><span class="p">:[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4333</span><span class="p">,</span> <span class="mi">1232343</span><span class="p">],</span> <span class="s">&quot;04-15&quot;</span><span class="p">:[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">45555</span><span class="p">,</span> <span class="mi">243432</span><span class="p">],</span> <span class="s">&quot;04-13&quot;</span><span class="p">:[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">14444</span><span class="p">,</span> <span class="mi">45454</span><span class="p">]},</span> \
</span><span class='line'>        <span class="s">&quot;serverE&quot;</span><span class="p">:{</span> <span class="s">&quot;04-12&quot;</span><span class="p">:[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4333</span><span class="p">,</span> <span class="mi">1232343</span><span class="p">],</span> <span class="s">&quot;04-15&quot;</span><span class="p">:[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">45555</span><span class="p">,</span> <span class="mi">343432</span><span class="p">],</span> <span class="s">&quot;04-13&quot;</span><span class="p">:[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">14444</span><span class="p">,</span> <span class="mi">45454</span><span class="p">]},</span> \
</span><span class='line'>        <span class="s">&quot;serverF&quot;</span><span class="p">:{</span> <span class="s">&quot;04-12&quot;</span><span class="p">:[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4333</span><span class="p">,</span> <span class="mi">1232343</span><span class="p">],</span> <span class="s">&quot;04-15&quot;</span><span class="p">:[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">45555</span><span class="p">,</span> <span class="mi">143432</span><span class="p">],</span> <span class="s">&quot;04-13&quot;</span><span class="p">:[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">14444</span><span class="p">,</span> <span class="mi">45454</span><span class="p">]},</span> \
</span><span class='line'>        <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/04/19/python-sort/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/18/usefull-git-and-rake-commands/">Usefull Git &amp; Rake Commands</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-18T21:37:00+08:00" pubdate data-updated="true">Apr 18<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content">
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/18/hi-octopress/">OctoPress. 安装使用中的坑</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-18T20:44:00+08:00" pubdate data-updated="true">Apr 18<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1.Ubuntu中如果装了两个版本的ruby在使用时会有问题</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rake new_post<span class="o">[</span><span class="s2">&quot;usefull git &amp; rake commands&quot;</span><span class="o">]</span>
</span><span class='line'>Could not find RedCloth-4.2.9 in any of the sources
</span><span class='line'>Run <span class="sb">`</span>bundle install<span class="sb">`</span> to install missing gems.
</span><span class='line'>
</span><span class='line'>解决办法： 可以使用rvm选择ruby版本
</span><span class='line'><span class="nv">$rvm</span> use ruby-1.9.2-p290
</span></code></pre></td></tr></table></div></figure>


<p>2.在执行</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git remote add origin git@github.com:defnngj/hello-world.git
</span><span class='line'>错误提示：
</span><span class='line'>fatal: remote origin already exists.
</span><span class='line'>
</span><span class='line'>解决办法：
</span><span class='line'><span class="nv">$ </span>git remote rm origin
</span><span class='line'><span class="nv">$ </span>git remote add origin git@github.com:defnngj/hello-world.git
</span><span class='line'>就不会报错误了
</span></code></pre></td></tr></table></div></figure>


<p>3.虽然按照官网流程完成了ssh相关的配置的安装，
但是deploy的时候还是提示Permission denied (publickey).错误</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rake deply
</span><span class='line'>Agent admitted failure to sign using the key.
</span><span class='line'>Permission denied <span class="o">(</span>publickey<span class="o">)</span>.
</span><span class='line'>
</span><span class='line'><span class="o">[</span>解决办法<span class="o">](</span>http://stackoverflow.com/questions/2546005/git-and-ssh-authorizating<span class="o">)</span>
</span><span class='line'><span class="nv">$ </span>sh-add ~/.ssh/id_rsa
</span></code></pre></td></tr></table></div></figure>


<p>4.<a href="http://blog.log4d.com/2012/05/tag-cloud/">添加标签和分类</a></p>

<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;以下是copy的安装流程&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-
http://blog.devtang.com/blog/2012/02/10/setup-blog-based-on-github/</p>

<div class="entry-content"><p>github真是无所不能。其<a href="http://pages.github.com/">Pages功能</a>支持上传html，并且在页面中显示。于是有好事者做了一个基于github的博客管理工具：<a href="http://octopress.org/">octopress</a>，基本原理是用git来管理你的文章，然后最终发布到github上成为一个独立博客站点。由于github支持CNAME域名指向，所以如果有独立域名的话，可以基于这些做出一个专业的博客站点出来。</p>

<p>本博客就是完全基于此搭建起来的，在使用了2个月之后，我将原系统根据中国人的需求做了一些配置，去掉了GFW会挡住的google font api，以及替换掉了速度超慢的国外的评论系统，也加上了分享到国内的微博的功能。现在把这些都总结出来，希望大家都可以方便地搭建基于github的博客来。</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/04/18/hi-octopress/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/python/'>python (4)</a></li><li><a href='/blog/categories/shell/'>shell (1)</a></li><li><a href='/blog/categories/tools/'>tools (1)</a></li></ul>
</section>
<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/python-effecive' style='font-size: 130.0%'>python.effecive(1)</a> <a href='/blog/categories/python-itemgetter' style='font-size: 130.0%'>python.itemgetter(1)</a> <a href='/blog/categories/python-iteratools' style='font-size: 130.0%'>python.iteratools(1)</a> <a href='/blog/categories/python-iterator' style='font-size: 130.0%'>python.iterator(1)</a> <a href='/blog/categories/python-join' style='font-size: 130.0%'>python.join(1)</a> <a href='/blog/categories/python-lambda' style='font-size: 130.0%'>python.lambda(1)</a> <a href='/blog/categories/python-map' style='font-size: 130.0%'>python.map(1)</a> <a href='/blog/categories/python-max' style='font-size: 130.0%'>python.max(1)</a> <a href='/blog/categories/python-reduce' style='font-size: 130.0%'>python.reduce(1)</a> <a href='/blog/categories/python-sort' style='font-size: 130.0%'>python.sort(1)</a> <a href='/blog/categories/python-tee' style='font-size: 130.0%'>python.tee(1)</a> <a href='/blog/categories/python-yield' style='font-size: 160.0%'>python.yield(2)</a> <a href='/blog/categories/shell-find' style='font-size: 130.0%'>shell.find(1)</a> </span>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/04/25/python-performance-tips/">Python Performance Tips</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/22/python-func/">Python 中有用的函数</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/21/python-tee/">Python Tee</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/21/linux-command-learning/">Linux Command 收集</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/19/python-sort/">Python 排序</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - tom -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
